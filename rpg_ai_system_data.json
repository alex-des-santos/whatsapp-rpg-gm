{
  "system_architecture": {
    "modules": {
      "whatsapp_integration": {
        "description": "Módulo de integração com WhatsApp Business API",
        "components": [
          "message_handler",
          "webhook_processor",
          "interactive_buttons"
        ],
        "dependencies": [
          "whatsapp-api-client-python",
          "flask",
          "requests"
        ]
      },
      "game_state_manager": {
        "description": "Gestor de estado do jogo para manter persistência",
        "components": [
          "character_manager",
          "world_state",
          "narrative_tracker"
        ],
        "data_categories": [
          "personagens",
          "estado_mundo",
          "regras_mecanicas"
        ]
      },
      "ai_module": {
        "description": "Módulo de IA com múltiplos provedores LLM",
        "components": [
          "llm_router",
          "prompt_engine",
          "narrative_generator"
        ],
        "supported_providers": [
          "openai",
          "anthropic",
          "google",
          "openrouter",
          "local_ollama"
        ]
      },
      "dice_system": {
        "description": "Sistema de rolagem de dados para D&D",
        "components": [
          "dice_roller",
          "skill_calculator",
          "combat_resolver"
        ],
        "dependencies": [
          "dicepy",
          "numpy"
        ]
      },
      "hitl_system": {
        "description": "Sistema humano-no-ciclo para intervenções do GM",
        "components": [
          "intervention_detector",
          "notification_sender",
          "transcription_manager"
        ],
        "triggers": [
          "conflito_regras",
          "decisao_critica",
          "narrativa_complexa"
        ]
      },
      "gui_interface": {
        "description": "Interface gráfica para controle do sistema",
        "framework": "streamlit",
        "features": [
          "real_time_monitoring",
          "ai_parameter_tuning",
          "manual_intervention"
        ]
      }
    },
    "integrations": {
      "llamaindex": {
        "purpose": "Fundamentação de lore e regras de D&D",
        "features": [
          "knowledge_retrieval",
          "rule_lookup",
          "lore_expansion"
        ]
      },
      "multi_llm": {
        "primary": "OpenAI GPT-4",
        "fallback": [
          "Anthropic Claude",
          "Google Gemini"
        ],
        "local": "Ollama Llama3"
      }
    }
  },
  "characters": [
    {
      "name": "Aria Nightwhisper",
      "class": "Ranger",
      "level": 5,
      "hp": {
        "current": 45,
        "max": 45
      },
      "stats": {
        "strength": 14,
        "dexterity": 18,
        "constitution": 16,
        "intelligence": 12,
        "wisdom": 15,
        "charisma": 10
      },
      "location": "Floresta Sombria",
      "inventory": [
        "Arco Élfico",
        "Aljava com 30 flechas",
        "Armadura de Couro",
        "Kit de Sobrevivência"
      ],
      "status": "healthy"
    },
    {
      "name": "Thorin Barbaferro",
      "class": "Fighter",
      "level": 4,
      "hp": {
        "current": 38,
        "max": 42
      },
      "stats": {
        "strength": 17,
        "dexterity": 13,
        "constitution": 15,
        "intelligence": 10,
        "wisdom": 12,
        "charisma": 14
      },
      "location": "Taverna do Dragão",
      "inventory": [
        "Machado de Batalha",
        "Escudo",
        "Armadura de Placas",
        "Poção de Cura"
      ],
      "status": "slightly_wounded"
    }
  ],
  "world_state": {
    "current_scene": "Investigação na Taverna",
    "active_quest": "O Mistério dos Comerciantes Desaparecidos",
    "npcs_present": [
      {
        "name": "Bartender Willem",
        "disposition": "friendly",
        "knows": "informações sobre comerciantes"
      },
      {
        "name": "Comerciante Suspeito",
        "disposition": "nervous",
        "knows": "pistas sobre o desaparecimento"
      }
    ],
    "environment": {
      "location": "Taverna do Dragão Dourado",
      "time": "Final da tarde",
      "weather": "Chuva leve",
      "mood": "tenso, suspeitas no ar"
    },
    "recent_events": [
      "Personagens chegaram à taverna",
      "Ouviram rumores sobre comerciantes desaparecidos",
      "Notaram comportamento suspeito de um cliente"
    ]
  },
  "prompt_examples": {
    "chain_of_thought": "\n    Como Mestre de Jogo experiente, analyze a situação atual e responda seguindo estes passos:\n    1. Avalie o contexto atual da aventura\n    2. Considere as ações dos jogadores\n    3. Determine as consequências narrativas\n    4. Calcule qualquer mecânica necessária\n    5. Descreva a resposta de forma imersiva\n\n    Situação: {situation}\n    Ação do jogador: {player_action}\n    ",
    "tree_of_thought": "\n    Você é um GM de D&D. Explore múltiplas possibilidades narrativas:\n\n    Ramificação A: Resposta direta à ação\n    Ramificação B: Complicação inesperada  \n    Ramificação C: Oportunidade para desenvolvimento de personagem\n\n    Avalie cada ramificação e escolha a que melhor serve a narrativa.\n    ",
    "lore_integration": "\n    Consulte o conhecimento de D&D para responder. Use informações sobre:\n    - Regras oficiais de D&D 5e\n    - Lore estabelecido de Forgotten Realms\n    - Mecânicas de combate e habilidades\n\n    Pergunta: {query}\n    "
  },
  "llm_configs": {
    "openai": {
      "model": "gpt-4",
      "temperature": 0.7,
      "max_tokens": 1000,
      "use_case": "Narrativa principal e diálogos complexos"
    },
    "anthropic": {
      "model": "claude-3-sonnet",
      "temperature": 0.6,
      "max_tokens": 1000,
      "use_case": "Análise de regras e decisões éticas"
    },
    "google": {
      "model": "gemini-pro",
      "temperature": 0.8,
      "max_tokens": 800,
      "use_case": "Geração criativa e descrições ambientais"
    },
    "local": {
      "model": "llama3:8b",
      "temperature": 0.5,
      "max_tokens": 600,
      "use_case": "Backup offline e operações simples"
    }
  },
  "features": {
    "whatsapp_integration": true,
    "multi_llm_support": true,
    "dice_rolling": true,
    "state_persistence": true,
    "human_intervention": true,
    "gui_interface": true,
    "llamaindex_integration": true
  }
}